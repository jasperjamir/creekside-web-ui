---
import { sanityClient } from "sanity:client";
import PageLayout from '../../layouts/PageLayout.astro';
import OurStory from './sections/our-story.astro';
import LifelongLearning from './sections/lifelong-learning.astro';
import MissionVision from './sections/mission-vision.astro';
import OurTeam from './sections/our-team.astro';
import WhatIsProfoundAutism from './sections/what-is-profound-autism.astro';

const QUERY = /* groq */ `*[_type == "whoWeAre"][0] {
  title,
  ourStoryText {
    heading,
    body,
    body2,
    image { asset->{ _id, url }, alt }
  },
  lifelongLearningText {
    headline,
    subheading,
    body,
    image { asset->{ _id, url }, alt }
  },
  missionVisionText {
    sectionHeading,
    mission,
    vision,
    image { asset->{ _id, url }, alt }
  },
  ourTeamText {
    sectionHeading,
    groups[] {
      title,
      description,
      images[] { asset->{ _id, url }, alt }
    }
  },
  whatIsProfoundAutismText {
    sectionHeading,
    definition,
    image { asset->{ _id, url }, alt },
    learnMoreHeading,
    supportLinksHeading,
    learnMoreLinks[] {
      name,
      href
    },
    supportLinks[] {
      name,
      href
    }
  }
}`;

const data = await sanityClient.fetch(QUERY);

const content = {
  pageTitle: data?.title ?? 'Who We Are - The Creekside School',
  ourStory: {
    heading: data?.ourStoryText?.heading ?? 'Our Story',
    body:
      data?.ourStoryText?.body ??
      'Founded by parents who faced challenges finding a suitable school.',
    body2:
      data?.ourStoryText?.body2 ??
      'Creekside is a community dedicated to individualized support and education for students with profound autism.',
    image: data?.ourStoryText?.image ?? undefined,
  },
  lifelongLearning: {
    headline:
      data?.lifelongLearningText?.headline ??
      'Lifelong learning begins with belonging, connection, and understanding.',
    subheading:
      data?.lifelongLearningText?.subheading ??
      "Guided by this belief, each student's unique set of interests, strengths, and needs drives the development of our individualized, comprehensive programs.",
    body:
      data?.lifelongLearningText?.body ??
      'Our emphasis on family and community stems from our recognition that autism affects more than just parents. It impacts the whole family and the people around them.',
    image: data?.lifelongLearningText?.image ?? undefined,
  },
  missionVision: {
    sectionHeading: data?.missionVisionText?.sectionHeading ?? 'Mission & Vision',
    mission:
      data?.missionVisionText?.mission ??
      'To holistically enhance the quality of life for individuals with profound autism and their families through empowerment, community engagement, and collaborative partnerships.',
    vision:
      data?.missionVisionText?.vision ??
      'To extend this through a lifetime — ensuring lifelong opportunities for growth, connection, and purpose.',
    image: data?.missionVisionText?.image ?? undefined,
  },
  ourTeam: {
    sectionHeading: data?.ourTeamText?.sectionHeading ?? 'Our Team',
    groups: data?.ourTeamText?.groups ?? [],
  },
  whatIsProfoundAutism: {
    sectionHeading: data?.whatIsProfoundAutismText?.sectionHeading ?? 'What is Profound Autism?',
    definition:
      data?.whatIsProfoundAutismText?.definition ??
      'Profound autism is a term used to describe individuals on the autism spectrum who have extremely high support needs — often characterized by limited or non-vocal communication abilities, significant challenges in adaptive functioning (e.g., daily living skills), and co-occurring medical or behavioral complexities.',
    image: data?.whatIsProfoundAutismText?.image ?? undefined,
    learnMoreHeading: data?.whatIsProfoundAutismText?.learnMoreHeading ?? 'Learn More:',
    supportLinksHeading: data?.whatIsProfoundAutismText?.supportLinksHeading ?? 'Support Creekside:',
    learnMoreLinks:
      data?.whatIsProfoundAutismText?.learnMoreLinks ?? [
        { name: 'Our Programs', href: '/what-we-do/' },
        { name: 'Our Students', href: '/families/' },
      ],
    supportLinks:
      data?.whatIsProfoundAutismText?.supportLinks ?? [
        { name: 'Donate', href: '/support/donate/' },
        { name: 'Volunteer', href: '/support/#volunteer' },
        { name: 'Student Wish List', href: '/support/#student-wish-list' },
        { name: 'Join Our Staff', href: '/join-us/join-our-team/' },
      ],
  },
};
---

<PageLayout title={content.pageTitle}>
  <div class="animate-fade-in font-sans">
    <OurStory {...content.ourStory} />
    <LifelongLearning {...content.lifelongLearning} />
    <MissionVision {...content.missionVision} />
    <OurTeam sectionHeading={content.ourTeam.sectionHeading} groups={content.ourTeam.groups} />
    <WhatIsProfoundAutism {...content.whatIsProfoundAutism} />
  </div>
</PageLayout>
