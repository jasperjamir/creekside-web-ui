---
import { sanityClient } from "sanity:client";
import HomeLayout from '../../layouts/HomeLayout.astro';
import HeroSection from './sections/hero.astro';
import CreeksideDifference from './sections/the-creekside-difference.astro';
import OurPillars from './sections/our-pillars.astro';
import CommunityPartners from './sections/community-partners.astro';
import NavigationGrid from './sections/navigation-grid.astro';
import Testimonials from './sections/testimonials.astro';
import CommunityImage from './sections/community-image.astro';

const QUERY = /* groq */ `*[_type == "home"][0] {
  heroText {
    imageAlt,
    badge,
    headingPrefix,
    headingHighlight,
    subheading,
    contactCta,
    donateCta,
    contactHref,
    donateHref
  },
  creeksideDifferenceText {
    heading,
    body
  },
  ourPillarsText {
    heading,
    subheading,
    pillars[] {
      title,
      icon,
      text
    }
  },
  communityPartnersText {
    heading,
    partners[] {
      name,
      image
    }
  },
  navigationGridText {
    heading,
    linkLabel,
    items[] {
      title,
      icon,
      link
    }
  },
  testimonialsText {
    heading,
    testimonials[] {
      text,
      author,
      role
    }
  },
  communityImageText {
    title,
    description
  }
}`;

const data = await sanityClient.fetch(QUERY);

// Extract data with fallbacks for development
const heroText = data?.heroText || {
  imageAlt: 'Adult and child engaged in art activity at Creekside School',
  badge: 'Welcome to Creekside',
  headingPrefix: 'Specialized Education for Students with ',
  headingHighlight: 'Profound Autism',
  subheading: 'At Creekside, we create tailored learning experiences and environments where students with profound autism are truly seen and understood.',
  contactCta: 'Contact Us',
  donateCta: 'Donate',
  contactHref: '/contact',
  donateHref: '/support/donate',
};

const creeksideDifferenceText = data?.creeksideDifferenceText || {
  heading: 'The Creekside Difference',
  body: 'At Creekside, we create tailored learning experiences and environments where students with profound autism are truly seen and understood.',
};

const ourPillarsText = data?.ourPillarsText || {
  heading: 'Our Pillars',
  subheading: 'The Creekside School serves a unique student population and their families. We take a special, holistic approach to educating students guided by 7 pillars, which create the foundation of our approach.',
  pillars: [],
};

const communityPartnersText = data?.communityPartnersText || {
  heading: 'Our heartfelt thanks to our community partners',
  partners: [],
};

const navigationGridText = data?.navigationGridText || {
  heading: 'What are you interested in learning about?',
  linkLabel: 'Learn More',
  items: [],
};

const testimonialsText = data?.testimonialsText || {
  heading: 'Join the Creekside Community',
  testimonials: [],
};

const communityImageText = data?.communityImageText || {
  title: '',
  description: '',
};
---

<HomeLayout title="Home - The Creekside School">
  <div class="animate-fade-in font-sans">
    <HeroSection {...heroText} />
    <CreeksideDifference {...creeksideDifferenceText} />
    <OurPillars {...ourPillarsText} />
    <CommunityPartners {...communityPartnersText} />
    <NavigationGrid {...navigationGridText} />
    <Testimonials {...testimonialsText} />
    <CommunityImage {...communityImageText} />
  </div>
</HomeLayout>
