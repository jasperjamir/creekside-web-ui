---
import { ASSETS_BASE_URL, COLORS } from '../../../constants';
import SectionHeading from '../../../components/ui/SectionHeading.astro';
import { IMPACT_HIGHLIGHTS } from '../_constants/impact-highlights';

function getImageSrc(src: string | null | undefined) {
  if (src == null || src === '') return '';
  return src.startsWith('http') ? src : `${ASSETS_BASE_URL}/images/${src}`;
}

// COLORS.green #A4D16A = rgb(164, 209, 106)
const greenRgb = '164, 209, 106';
---

<section class="impact-section font-sans relative" style={{ backgroundColor: COLORS.blue.navy }}>
  <div class="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] opacity-5"></div>
  <div class="container relative z-10">
    <div class="title-wrapper">
      <SectionHeading>Impact Highlights</SectionHeading>
    </div>

    <div class="grid">
      {IMPACT_HIGHLIGHTS.map((item) => (
        <article class="card">
          <div class="card-image-wrapper">
            <img
              src={getImageSrc(item.imageSrc)}
              alt={item.title ? `${item.title} at Creekside School` : 'Impact at Creekside School'}
              class="card-bg"
              loading="lazy"
              width="450"
              height="600"
            />
          </div>
          <div class="card-content" style={{ background: `linear-gradient(to bottom, rgba(${greenRgb}, 0) 0%, rgba(${greenRgb}, 0.6) 20%, rgba(${greenRgb}, 0.9) 100%)` }}>
            <h3 style={{ color: COLORS.blue.navy }}>{item.title}:</h3>
            <p style={{ color: COLORS.blue.navy }}>{item.description}</p>
          </div>
        </article>
      ))}
    </div>
  </div>
</section>

<style>
  .impact-section {
    padding: 4rem 5%;
    font-family: inherit;
  }

  .container {
    max-width: 1200px;
    margin: 0 auto;
  }

  .title-wrapper {
    display: flex;
    justify-content: center;
    margin-bottom: 3rem;
  }

  .grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 1.5rem;
  }

  @media (min-width: 768px) {
    .grid {
      grid-template-columns: repeat(3, 1fr);
    }
  }

  .card {
    position: relative;
    border-radius: 1rem;
    overflow: hidden;
    aspect-ratio: 3 / 4;
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
    box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
  }

  .card-image-wrapper {
    position: absolute;
    inset: 0;
    z-index: 0;
  }

  .card-bg {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: center;
  }

  .card-content {
    position: relative;
    z-index: 1;
    padding: 1.5rem;
  }

  .card-content h3 {
    font-size: 1.25rem;
    font-weight: 700;
    margin: 0 0 0.5rem 0;
    line-height: 1.2;
  }

  .card-content p {
    font-size: 1.1rem;
    margin: 0;
    line-height: 1.5;
    font-weight: 400;
  }
</style>
